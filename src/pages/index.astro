---
import { Image } from 'astro:assets';

import '@fontsource/merriweather/300.css';
import '@fontsource/merriweather';
import '@fontsource/open-sans/300.css';

import heroBgImage from '../assets/hero-bg-image.png'
import logoImage from '../assets/logo.svg'
import logoDarkImage from '../assets/logo-dark.svg'

import Layout from '../layouts/Layout.astro';
import AppButton from '../components/AppButton.astro';

import thumbUpIcon from '../assets/icons/thumb-up.svg'
import outlineDiamondIcon from '../assets/icons/outline-diamond.svg'
import personIcon from '../assets/icons/person.svg'
import gearIcon from '../assets/icons/gear.svg'
import hamburgerIcon from '../assets/icons/hamburger.svg'

import arrowBackIcon from '../assets/icons/arrow-back.svg'
import arrowForwardIcon from '../assets/icons/arrow-forward.svg'
import worldMap from '../assets/world.svg'

import interior1 from '../assets/interior-1.jpg'
import interior2 from '../assets/interior-2.webp'
import products from '../assets/products.webp'
import Icon from 'astro-icon';
import MobileNavigationMenu from '../components/MobileNavigationMenu.astro';

const features = [
	{
		title: 'Efficient',
		icon: thumbUpIcon
	},
	{
		title: 'High-Quality',
		icon: outlineDiamondIcon
	},
	{
		title: 'Professional',
		icon: personIcon
	},
	{
		title: 'Customizable',
		icon: gearIcon
	},
]

const presentationSlides = Array.from({length: 26}, (_, i) => i + 1).map(value => `/presentation/${value}.jpg`)
---

<Layout>
	<div class="relative grid place-items-center w-full h-[100vh]" id="home">
		<MobileNavigationMenu />

		<header id="mainHeader" class="fixed left-0 top-0 w-full flex flex-col items-center z-[30] py-3 transition-all">
			<div class="container flex flex-row items-center justify-between">
				<Image class="h-[60px] lg:h-[80px]" height={80} src={logoImage} alt="HataHub logo"/>
				<div class="hidden lg:flex flex-row gap-10 items-center hover:[&>a]:underline">
					<a href="#home">home</a>
					<a href="#aboutUs">about us</a>
					<a href="#products">our products</a>
					<a href="#whereWeWork">where we work?<a>
					<a href="#footer">contacts</a>
				</div>
				<button class="mobile-navigation-activator px-6 py-4">
					<Image height={40} src={hamburgerIcon} alt="Navigation menu button"/>
				</button>
			</div>
		</header>

		<div class="flex flex-col items-center relative z-[20] w-3/4 text-center gap-6 pt-12 lg:pt-0">
			<h1 class="text-[30px] lg:text-[60px] text-white">
				European Window and Door Excellence – Now in Canada
			</h1>
			<span class="text-center text-sm lg:text-base">Step into a realm of sophisticated style and unmatched efficiency with our European window and door systems. Crafted to meet the highest standards of quality, our products are designed to bring your boldest design visions to life while ensuring peak energy efficiency and durability. Get a personalized quote today and discover how we can transform your space into a vision of elegance</span>
			<AppButton buttonStyle='outline' href="#contact">get a quote</AppButton>
		</div>

		<!-- Background image -->
		<div class="absolute w-full h-full left-0 top-0 backdrop-brightness-50 z-[10]"> </div>
		<Image class='absolute w-full h-full left-0 top-0 object-cover z-[5]' src={heroBgImage} alt='Hero Bg Image' />
	</div>
	<section id="features">
		<div class="container flex flex-col lg:flex-row justify-around mx-auto py-16">
			{features.map((feature) => (
				<div class="flex flex-col-reverse lg:flex-col items-center gap-2 py-2 lg:py-0 lg:gap-6">
					<span class="text-black/90">{feature.title}</span>
					<Image class="opacity-[90%]" width={40} alt={`${feature.title} icon`} src={feature.icon}/>
				</div>
			))}
		</div>
	</section>
	<Image class="object-cover h-[200px] opacity-[60%]" src={interior1} alt='Interior image'/>
	<section class="py-20" id="aboutUs">
		<div class="container mx-auto flex flex-col items-stretch lg:grid grid-cols-2 gap-6 lg:gap-32">
			<Image class="object-cover aspect-square" src={interior2} alt="About us section image"/>
			<div class="flex flex-col items-start justify-center gap-6 text-black">
				<h2 class="text-[60px]">A<span class="text-[50px]">BOUT US</span></h2>
				<span>
					Discover Elegance with HATAHUB LTD: Premium European Windows & Doors Now in Canada. Unmatched Quality, Exceptional Design, Tailored for Your Home. Experience the Blend of Tradition and Innovation in Every Product We Offer
				</span>
				<AppButton buttonStyle='success' href="#contact">get a quote</AppButton>
			</div>
		</div>
	</section>
	<section class="py-20" id="products">
		<div class="container mx-auto flex flex-col-reverse items-stretch lg:grid grid-cols-2 gap-8 lg:gap-32">
			<div class="flex flex-col items-end lg:items-start justify-center gap-6 text-black lg:text-left text-right">
				<h2 class="text-[60px] ">
					O<span class="text-[50px]">UR</span> 
					P<span class="text-[50px]">RODUCTS</span>
				</h2>
				<span class="lg:text-left text-right">
					Experience superior craftsmanship with HATAHUB LTD’s range of European windows and doors. Engineered for elegance and durability, our products blend advanced German technology with contemporary design, offering unparalleled quality to enhance your spaces in Canada.
				</span>
				<AppButton buttonStyle='success' href="#contact">get a quote</AppButton>
			</div>
			<Image class="object-[100%] aspect-square" src={products} alt="Products section image"/>
		</div>
	</section>
	<section class="py-20" id="whereWeWork">
		<div class="container mx-auto flex flex-col items-stretch lg:grid grid-cols-2 gap-6 lg:gap-32">
			<Image class="object-[100%] aspect-square" src={worldMap} alt="About us section image"/>
			<div class="flex flex-col items-start justify-center gap-6 text-black">
				<h2 class="text-[60px]">W<span class="text-[50px]">HERE WE WORK</span></h2>
				<span>
					At HATAHUB LTD, we are proud to serve the vibrant and diverse communities across Ontario. From the bustling streets of Toronto and Ottawa to the dynamic neighborhoods of Mississauga and Brampton, we bring our expertise in European windows to each corner of the province. Whether you're in the historic city of Hamilton, the thriving hub of London, or the growing areas of Markham and Vaughan, our commitment to quality and service remains the same. We also cater to the unique needs of Kitchener and Windsor, ensuring that each city’s distinct character is reflected in our offerings. Wherever you are in Ontario, HATAHUB LTD is here to enhance your spaces with the finest European windows
				</span>
				<AppButton buttonStyle='success' href="#contact">get a quote</AppButton>
			</div>
		</div>
	</section>
	<section class="text-black mt-16" id="contact">
		<h2 class="text-[60px] text-center mb-12">G<span class="text-[50px]">ET</span>&nbsp;A Q<span class="text-[50px]">UOTE</span></h2>
		<form id="contactForm" action="#" class="w-full lg:w-[400px] flex flex-col items-stretch gap-3 mx-auto [&>label]:flex [&>label]:flex-col [&>label]:items-stretch">
			<label class="flex flex-col items-stretch gap-1">
				Name*
				<input id="contactForm_name" placeholder="Enter your name here (required)" class="border border-[#608273]/50 py-2 pl-5 rounded-md" type="text" required/>
			</label>
			<label class="flex flex-col items-stretch gap-1">
				E-mail*
				<input id="contactForm_email" placeholder="Enter your e-mail here (required)" class="border border-[#608273]/50 py-2 pl-5 rounded-md" type="email" required/>
			</label>
			<label class="flex flex-col items-stretch gap-1">
				Phone number
				<input id="contactForm_phoneNumber" placeholder="Enter your phone number here (optional)" class="border border-[#608273]/50 py-2 pl-5 rounded-md" type="text" />
			</label>
			<label class="flex flex-col items-stretch gap-1">
				Additional information
				<textarea id="contactForm_additionalInformation" placeholder="Enter additional information here (optional)" class="border border-[#608273]/50 py-2 pl-5 rounded-md" />
			</label>
			<label class="flex flex-col items-stretch gap-1">
				Attachment (optional)
				<input id="contactForm_attachment" class="border border-[#608273]/50 rounded-lg bg-[#608273]/20 pl-2 py-2 hover:cursor-pointer" type="file"/>
			</label>
			<button class="px-16 py-3 bg-[#28E48E] text-white shadow rounded-lg" type="submit">Submit</button>
		</form>
	</section>
	<footer id="footer" class="bg-[#E1E0DA] text-black mt-16 px-6">
		<div class="container mx-auto flex flex-col items-stretch gap-2 lg:grid grid-cols-[1fr_2fr] py-10">
			<div class="flex flex-col items-stretch gap-12">
				<div class="flex flex-row items-center gap-4">
					<Image height={100} src={logoDarkImage} alt='Footer HataHub logo'/>
					<h2 class="text-[40px] lg:text-[60px] leading-[1]">
						H<span class="!font-heading text-[30px] lg:text-[50px]">ATA</span>H<span class="!font-heading text-[30px] lg:text-[50px]">UB</span>
					</h2>
				</div>
				<div class="flex flex-col items-stretch lg:grid grid-cols-2 auto-rows-auto gap-y-8 opacity-80">
					<span class="text-4xl font-normal col-span-2">
						Contact us
					</span>
					<a href="tel:+16475585577" class="flex flex-row gap-4 items-center">
						<Icon class="h-[30px]" name="mdi:phone"/>
						<span>+1 (647) 558-5577</span>
					</a>
					<a href="mailto:info@hatahub.ca" class="flex flex-row gap-4 items-center">
						<Icon class="h-[30px]" name="mdi:email"/>
						<span>info@hatahub.ca</span>
					</a>
					<div class="flex flex-row gap-4 items-center">
						<a href="https://www.facebook.com/profile.php?id=61552284022721">
							<Icon class="h-[30px]" name="mdi:facebook"/>
						</a>
						<a href="https://www.instagram.com/hatahub.ca/">
							<Icon class="h-[30px]" name="mdi:instagram"/>
						</a>
						<a href="https://www.linkedin.com/in/alex-hatahub-433a9a294">
							<Icon class="h-[30px]" name="mdi:linkedin"/>
						</a>
					</div>
				</div>
				<div class="grid grid-cols-2 auto-rows-auto gap-y-8 opacity-80">
					<span class="text-4xl font-normal col-span-2">
						Where are we?
					</span>
					<span>Toronto, Ontario</span>
				</div>
			</div>
		</div>
	</footer>
</Layout>

<style>
body {
	@apply font-main font-light text-white tracking-widest;
}

h1, h2, h3, h4, h5, h6 {
	@apply font-heading font-light;
}

section {
	@apply lg:px-0 px-6;
}
</style>

<script>

const readFileAsDataUrl = (file: File): Promise<string> => {
	return new Promise((resolve, reject) => {
		const fileReader = new FileReader()

		fileReader.addEventListener(
			'load',
			() => {
				resolve(fileReader.result as string)
			}
		)

		fileReader.addEventListener(
			'error',
			(err) => {
				reject(err)
			}
		)

		fileReader.readAsDataURL(file)
	})
}

document.addEventListener('DOMContentLoaded', () => {
	const attachmentInput = document.getElementById('contactForm_attachment') as HTMLInputElement

	const FILE_SIZE_LIMIT = 5_242_880 //5MB

	//upload file size limiter
	attachmentInput.addEventListener('change', (ev) => {
		if(!attachmentInput.files) return 

		if(attachmentInput.files[0].size > FILE_SIZE_LIMIT) {
			alert('Maximum file size is 5MB!')
			attachmentInput.value = "";
			ev.preventDefault()
		}
	})

	const contactForm = document.getElementById('contactForm') as HTMLFormElement

	contactForm.addEventListener('submit', async (ev) => {
		ev.preventDefault()

		const nameInput = document.getElementById('contactForm_name') as HTMLInputElement
		const emailInput = document.getElementById('contactForm_email') as HTMLInputElement
		const phoneNumberInput = document.getElementById('contactForm_phoneNumber') as HTMLInputElement
		const additionalInformationInput = document.getElementById('contactForm_additionalInformation') as HTMLInputElement
		const attachmentInput = document.getElementById('contactForm_attachment') as HTMLInputElement

		const name = nameInput.value
		const email = emailInput.value
		const phoneNumber = phoneNumberInput.value
		const additionalInformation = additionalInformationInput.value
		const attachmentFile = attachmentInput.files?.[0]

		const attachment = attachmentFile ? await readFileAsDataUrl(attachmentFile) : undefined

		const formData = {
			name,
			email,
			phoneNumber,
			additionalInformation,
			attachment
		}

    await fetch('https://mailchannels.hatahub.ca', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(formData)
    })
	})
})

const handleScroll = () => {
	const headerElement = document.getElementById('mainHeader')
	if(!headerElement) return

	if(window.scrollY <= 10) {
		headerElement.style.background = 'rgba(0,0,0,0)'
	} else {
		headerElement.style.background = 'rgba(0,0,0,0.7)'
	}
}

document.addEventListener('scroll', handleScroll)
handleScroll()

document.querySelectorAll('a[href^="#"]').forEach(anchor => {
	anchor.addEventListener('click', function (e) {
		e.preventDefault();

		const href = (e.target as HTMLAnchorElement | null)?.getAttribute('href')

		if(!href) return

		document.querySelector(href)?.scrollIntoView({
			behavior: 'smooth'
		});
	});
});


</script>