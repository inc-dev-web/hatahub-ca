---
import { Image } from 'astro:assets';

import '@fontsource/merriweather/300.css';
import '@fontsource/merriweather';
import '@fontsource/open-sans/300.css';

import heroBgImage from '../assets/hero-bg-image.png'
import logoImage from '../assets/logo.svg'
import logoDarkImage from '../assets/logo-dark.svg'

import Layout from '../layouts/Layout.astro';
import AppButton from '../components/AppButton.astro';

import thumbUpIcon from '../assets/icons/thumb-up.svg'
import outlineDiamondIcon from '../assets/icons/outline-diamond.svg'
import personIcon from '../assets/icons/person.svg'
import gearIcon from '../assets/icons/gear.svg'

import arrowBackIcon from '../assets/icons/arrow-back.svg'
import arrowForwardIcon from '../assets/icons/arrow-forward.svg'
import worldMap from '../assets/world.svg'

import interior1 from '../assets/interior-1.jpg'
import interior2 from '../assets/interior-2.jpg'
import Icon from 'astro-icon';

const features = [
	{
		title: 'Efficient',
		icon: thumbUpIcon
	},
	{
		title: 'High-Quality',
		icon: outlineDiamondIcon
	},
	{
		title: 'Professional',
		icon: personIcon
	},
	{
		title: 'Customizable',
		icon: gearIcon
	},
]

const presentationSlides = Array.from({length: 26}, (_, i) => i + 1).map(value => `/presentation/${value}.jpg`)
---

<Layout>
	<div class="relative grid place-items-center w-full h-[100dvh]" id="home">
		<header id="mainHeader" class="lg:fixed left-0 top-0 w-full flex flex-col items-center z-[30] py-3 transition-all">
			<div class="container flex flex-row items-center justify-between">
				<Image height={80} src={logoImage} alt="HataHub logo"/>
				<div class="hidden lg:flex flex-row gap-10 items-center hover:[&>a]:underline">
					<a href="#home">home</a>
					<a href="#aboutUs">about us</a>
					<a href="#products">products</a>
					<a href="#presentation">presentation</a>
					<a href="#footer">contacts</a>
				</div>
			</div>
		</header>

		<div class="flex flex-col items-center relative z-[20] w-3/4 text-center gap-6">
			<h1 class="text-[30px] lg:text-[60px] text-white">
				European Window and Door Excellence – Now in Canada
			</h1>
			<span class="text-center text-sm lg:text-base">Step into a realm of sophisticated style and unmatched efficiency with our European window and door systems. Crafted to meet the highest standards of quality, our products are designed to bring your boldest design visions to life while ensuring peak energy efficiency and durability. Get a personalized quote today and discover how we can transform your space into a vision of elegance</span>
			<AppButton buttonStyle='outline' href="#contact">get a quote</AppButton>
		</div>

		<!-- Background image -->
		<div class="absolute w-full h-full left-0 top-0 backdrop-brightness-50 z-[10]"> </div>
		<Image class='absolute w-full h-full left-0 top-0 object-cover z-[5]' src={heroBgImage} alt='Hero Bg Image' />
	</div>
	<section id="features">
		<div class="container flex flex-col lg:flex-row justify-around mx-auto py-16">
			{features.map((feature) => (
				<div class="flex flex-col items-center gap-6">
					<span class="text-black/90">{feature.title}</span>
					<Image class="opacity-[90%]" width={40} alt={`${feature.title} icon`} src={feature.icon}/>
				</div>
			))}
		</div>
	</section>
	<Image class="object-cover h-[200px] opacity-[60%]" src={interior1} alt='Interior image'/>
	<section class="py-20" id="aboutUs">
		<div class="container mx-auto flex flex-col items-stretch lg:grid grid-cols-2 gap-6 lg:gap-32">
			<Image class="object-cover aspect-square" src={interior2} alt="About us section image"/>
			<div class="flex flex-col items-start justify-center gap-6 text-black">
				<h2 class="text-[60px]">A<span class="text-[50px]">BOUT US</span></h2>
				<span>
					Discover the epitome of European sophistication with HATAHUB LTD, your premier source for exquisitely crafted aluminum and uPVC windows and doors in Ontario. Situated in the heart of Toronto, we extend our reach to cities such as London, Ottawa, Windsor, Hamilton, and beyond, imparting a touch of European finesse to every corner of the province. Our collection features German-engineered windows and doors that embody a legacy of unparalleled quality and precision. Emphasizing high-grade German profiles and hardware, our products transcend mere installations—they are statements of luxury and efficiency. Our unwavering commitment to authenticity ensures that each piece we offer is a genuine European creation, meticulously designed to enhance the architecture and ambiance of your home.
				</span>
				<AppButton buttonStyle='success' href="#contact">get a quote</AppButton>
			</div>
		</div>
	</section>
	<section class="py-20" id="products">
		<div class="container mx-auto flex flex-col-reverse items-stretch lg:grid grid-cols-2 gap-8 lg:gap-32">
			<div class="flex flex-col items-end lg:items-start justify-center gap-6 text-black lg:text-left text-right">
				<h2 class="text-[60px] ">P<span class="text-[50px]">RODUCTS</span></h2>
				<span class="lg:text-left text-right">
					Whether you're undertaking renovations in London, constructing a new residence in Ottawa, rejuvenating your estate in Windsor, or updating a historic home in Hamilton, our doors and windows come with a promise: to deliver unparalleled European quality and performance. We provide an extensive array of colors and styles, carefully curated to complement the diverse Canadian palette and preferences. Rest assured, our products are backed by up to a 7-year warranty, ensuring enduring satisfaction. Through our direct collaboration with a distinguished Ukrainian manufacturer, we not only guarantee European quality but also remarkable turnaround times, with production and delivery achievable within 8 weeks. HATAHUB LTD is dedicated to bringing European standards to Canadian soil, ensuring that, no matter where you are in Ontario, you can experience the pinnacle of European craftsmanship.
				</span>
				<AppButton buttonStyle='success' href="#contact">get a quote</AppButton>
			</div>
			<Image class="object-[100%] aspect-square" src={worldMap} alt="About us section image"/>
		</div>
	</section>
	<section class="text-black relative" id="presentation">
		<h2 class="text-[40px] lg:text-[60px] text-center mb-12">O<span class="text-[30px] lg:text-[50px]">UR</span> P<span class="text-[30px] lg:text-[50px]">RESENTATION</span></h2>
		<button id="sliderButtonPrev" class="hidden lg:block absolute top-1/2 left-[40px] hover:cursor-pointer z-[30]">
			<Image src={arrowBackIcon} alt='Arrow back icon'/>
		</button>
		<swiper-container class="max-w-[100dvw] overflow-hidden" id="sliderContainer" initial-slide="0" effect="cards" slides-per-view="1.5" centered-slides="true" cards-effect-per-slide-offset="20" cards-effect-rotate="false">
			{presentationSlides.map((slide, index) => (
				<swiper-slide class="opacity-50 [&.swiper-slide-active]:!opacity-100 transition-all w-[400px]">
					<Image class="h-full w-full object-cover" width={1000} height={1000} src={slide} alt={`Slide ${index} image`}/>
				</swiper-slide>
			))}
		</swiper-container>
		<button id="sliderButtonNext" class="hidden lg:block absolute top-1/2 right-[40px] hover:cursor-pointer z-[30]">
			<Image src={arrowForwardIcon} alt='Arrow forward icon'/>
		</button>
	</section>
	<section class="text-black mt-16" id="contact">
		<h2 class="text-[60px] text-center mb-12">G<span class="text-[50px]">ET</span>&nbsp;A Q<span class="text-[50px]">UOTE</span></h2>
		<form id="contactForm" action="#" class="w-full lg:w-[400px] flex flex-col items-stretch gap-3 mx-auto [&>label]:flex [&>label]:flex-col [&>label]:items-stretch">
			<label class="flex flex-col items-stretch gap-1">
				Name*
				<input id="contactForm_name" placeholder="Enter your name here (required)" class="border border-[#608273]/50 py-2 pl-5 rounded-md" type="text" required/>
			</label>
			<label class="flex flex-col items-stretch gap-1">
				E-mail*
				<input id="contactForm_email" placeholder="Enter your e-mail here (required)" class="border border-[#608273]/50 py-2 pl-5 rounded-md" type="email" required/>
			</label>
			<label class="flex flex-col items-stretch gap-1">
				Phone number
				<input id="contactForm_phoneNumber" placeholder="Enter your phone number here (optional)" class="border border-[#608273]/50 py-2 pl-5 rounded-md" type="text" />
			</label>
			<label class="flex flex-col items-stretch gap-1">
				Additional information
				<textarea id="contactForm_additionalInformation" placeholder="Enter additional information here (optional)" class="border border-[#608273]/50 py-2 pl-5 rounded-md" />
			</label>
			<label class="flex flex-col items-stretch gap-1">
				Attachment (optional)
				<input id="contactForm_attachment" class="border border-[#608273]/50 rounded-lg bg-[#608273]/20 pl-2 py-2 hover:cursor-pointer" type="file"/>
			</label>
			<button class="px-16 py-3 bg-[#28E48E] text-white shadow rounded-lg" type="submit">Submit</button>
		</form>
	</section>
	<footer id="footer" class="bg-[#E1E0DA] text-black mt-16 px-6">
		<div class="container mx-auto flex flex-col items-stretch gap-2 lg:grid grid-cols-[1fr_2fr] py-10">
			<div class="flex flex-col items-stretch gap-12">
				<div class="flex flex-row items-center gap-4">
					<Image height={100} src={logoDarkImage} alt='Footer HataHub logo'/>
					<h2 class="text-[40px] lg:text-[60px] leading-[1]">
						H<span class="!font-heading text-[30px] lg:text-[50px]">ATA</span>H<span class="!font-heading text-[30px] lg:text-[50px]">UB</span>
					</h2>
				</div>
				<div class="flex flex-col items-stretch lg:grid grid-cols-2 auto-rows-auto gap-y-8 opacity-80">
					<span class="text-4xl font-normal col-span-2">
						Contact us
					</span>
					<a href="tel:+16475585577" class="flex flex-row gap-4 items-center">
						<Icon class="h-[30px]" name="mdi:phone"/>
						<span>+1 (647) 558-5577</span>
					</a>
					<a href="mailto:info@hatahub.ca" class="flex flex-row gap-4 items-center">
						<Icon class="h-[30px]" name="mdi:email"/>
						<span>info@hatahub.ca</span>
					</a>
					<div class="flex flex-row gap-4 items-center">
						<a href="https://www.facebook.com/profile.php?id=61552284022721">
							<Icon class="h-[30px]" name="mdi:facebook"/>
						</a>
						<a href="https://www.instagram.com/hatahub.ca/">
							<Icon class="h-[30px]" name="mdi:instagram"/>
						</a>
						<a href="https://www.linkedin.com/in/alex-hatahub-433a9a294">
							<Icon class="h-[30px]" name="mdi:linkedin"/>
						</a>
					</div>
				</div>
				<div class="grid grid-cols-2 auto-rows-auto gap-y-8 opacity-80">
					<span class="text-4xl font-normal col-span-2">
						Where are we?
					</span>
					<span>Toronto, Ontario</span>
				</div>
			</div>
		</div>
	</footer>
</Layout>

<style>
body {
	@apply font-main font-light text-white tracking-widest;
}

h1, h2, h3, h4, h5, h6 {
	@apply font-heading font-light;
}

section {
	@apply lg:px-0 px-6;
}
</style>

<script>
import { register, type SwiperContainer } from 'swiper/element/bundle';
register()

const readFileAsDataUrl = (file: File): Promise<string> => {
	return new Promise((resolve, reject) => {
		const fileReader = new FileReader()

		fileReader.addEventListener(
			'load',
			() => {
				resolve(fileReader.result as string)
			}
		)

		fileReader.addEventListener(
			'error',
			(err) => {
				reject(err)
			}
		)

		fileReader.readAsDataURL(file)
	})
}

document.addEventListener('DOMContentLoaded', () => {
	const swiperContainer = document.getElementById('sliderContainer') as SwiperContainer
	const prevButton = document.getElementById('sliderButtonPrev')
	const nextButton = document.getElementById('sliderButtonNext')

	prevButton?.addEventListener('click', () => {
		swiperContainer.swiper.slidePrev()
	})

	nextButton?.addEventListener('click', () => {
		swiperContainer.swiper.slideNext()
	})

	const attachmentInput = document.getElementById('contactForm_attachment') as HTMLInputElement

	const FILE_SIZE_LIMIT = 5_242_880 //5MB

	//upload file size limiter
	attachmentInput.addEventListener('change', (ev) => {
		if(!attachmentInput.files) return 

		if(attachmentInput.files[0].size > FILE_SIZE_LIMIT) {
			alert('Maximum file size is 5MB!')
			attachmentInput.value = "";
			ev.preventDefault()
		}
	})

	const contactForm = document.getElementById('contactForm') as HTMLFormElement

	contactForm.addEventListener('submit', async (ev) => {
		ev.preventDefault()

		const nameInput = document.getElementById('contactForm_name') as HTMLInputElement
		const emailInput = document.getElementById('contactForm_email') as HTMLInputElement
		const phoneNumberInput = document.getElementById('contactForm_phoneNumber') as HTMLInputElement
		const additionalInformationInput = document.getElementById('contactForm_additionalInformation') as HTMLInputElement
		const attachmentInput = document.getElementById('contactForm_attachment') as HTMLInputElement

		const name = nameInput.value
		const email = emailInput.value
		const phoneNumber = phoneNumberInput.value
		const additionalInformation = additionalInformationInput.value
		const attachmentFile = attachmentInput.files?.[0]

		const attachment = attachmentFile ? await readFileAsDataUrl(attachmentFile) : undefined

		const formData = {
			name,
			email,
			phoneNumber,
			additionalInformation,
			attachment
		}

    await fetch('https://mailchannels.hatahub.ca', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(formData)
    })
	})
})

const handleScroll = () => {
	const headerElement = document.getElementById('mainHeader')
	if(!headerElement) return

	if(window.scrollY <= 10) {
		headerElement.style.background = 'rgba(0,0,0,0)'
	} else {
		headerElement.style.background = 'rgba(0,0,0,0.7)'
	}
}

document.addEventListener('scroll', handleScroll)
handleScroll()

document.querySelectorAll('a[href^="#"]').forEach(anchor => {
	anchor.addEventListener('click', function (e) {
		e.preventDefault();

		const href = (e.target as HTMLAnchorElement | null)?.getAttribute('href')

		if(!href) return

		document.querySelector(href)?.scrollIntoView({
			behavior: 'smooth'
		});
	});
});


</script>